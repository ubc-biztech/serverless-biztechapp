'use strict';

// tests for userGet
// Generated by serverless-mocha-plugin

const mochaPlugin = require('serverless-mocha-plugin');
const expect = mochaPlugin.chai.expect;
let wrapped = mochaPlugin.getWrapper('userGet', '/handlers/user.js', 'get');

// If want to invoke mocha instead of sls invoke
// let wrapped = mochaPlugin.getWrapper('userGet', '../../../handlers/user.js', 'get');

const AWS = require('aws-sdk-mock');

AWS.mock('DynamoDB.DocumentClient', 'get', function (params, callback){
  if (params.Key.id == 332332) {
    Promise.resolve(
      callback(null, {
        Item: 'not null user'
      } 
    ));
  }
});


describe('userGet', () => {
  before((done) => {
    done();
  });

  it('successfully get user', async () => {
    const response = await wrapped.run({
      queryStringParameters: {
        id: '332332'
      }
    });
    expect(response).to.not.be.empty;
    expect(response.statusCode).to.equal(200);
  });
});
